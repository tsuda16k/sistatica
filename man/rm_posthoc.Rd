% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis-anova.R
\name{rm_posthoc}
\alias{rm_posthoc}
\title{Repeated-measures post-hoc comparisons (paired t) with dz and CIs}
\usage{
rm_posthoc(
  data,
  dv,
  within,
  id,
  conf_level = 0.95,
  p_adjust_method = "holm",
  ci_adjust_method = c("bonferroni", "none", "sidak"),
  missing = c("pairwise", "complete_case"),
  duplicate = c("mean", "median", "first", "error"),
  duplicate_na_rm = TRUE
)
}
\arguments{
\item{data}{A data.frame in long format.}

\item{dv}{Dependent variable (numeric). Unquoted name or string.}

\item{within}{Within-subject factor. Unquoted name or string.}

\item{id}{Subject identifier. Unquoted name or string.}

\item{conf_level}{Confidence level for unadjusted effect-size CIs (default: 0.95).}

\item{p_adjust_method}{P-value adjustment method passed to \code{rstatix} (default: \code{"holm"}).}

\item{ci_adjust_method}{CI multiplicity adjustment method (default: \code{"bonferroni"}).}

\item{missing}{Missing-data strategy: \code{"pairwise"} (default) or \code{"complete_case"}.}

\item{duplicate}{How to handle duplicated ID x within cells: \code{"mean"} (default), \code{"median"}, \code{"first"}, \code{"error"}.}

\item{duplicate_na_rm}{Logical; if TRUE, removes NAs within duplicated cells before aggregation (default: TRUE).}
}
\value{
A tibble with one row per pairwise comparison.
Columns:
\itemize{
  \item \code{design}: Design label (\code{"parametric_within"}).
  \item \code{method}: Post-hoc method label (\code{"paired_t"}).
  \item \code{term}: Name of the within-factor.
  \item \code{group1}, \code{group2}: Level names for the pairwise comparison.
  \item \code{statistic_type}: Type of test statistic (\code{"t"}).
  \item \code{statistic}: Test statistic value.
  \item \code{df}: Degrees of freedom (t-test).
  \item \code{p}: Unadjusted p-value for the pairwise test.
  \item \code{p_adj}: Adjusted p-value (according to \code{p_adjust_method}).
  \item \code{p_adj_mark}: Visual marker for significance based on \code{p_adj}: \code{"*"} if \code{p_adj < 0.05},
  otherwise \code{""} (including when \code{p_adj} is \code{NA}).
  \item \code{p_adjust_method}: The p-value adjustment method used.
  \item \code{effect_size}: Effect size estimate (\eqn{d_z}).
  \item \code{effect_size_type}: Effect size label (\code{"dz"}).
  \item \code{ci_level}: Confidence level used for the unadjusted effect-size CI.
  \item \code{ci_low}, \code{ci_high}: Lower/upper bounds of the unadjusted effect-size CI.
  \item \code{ci_adjust_method}: Method used to adjust effect-size CIs (\code{"none"}, \code{"bonferroni"}, \code{"sidak"}).
  \item \code{ci_level_adj}: Adjusted CI level implied by \code{ci_adjust_method} and the number of comparisons.
  \item \code{ci_low_adj}, \code{ci_high_adj}: Lower/upper bounds of the adjusted effect-size CI.
  \item \code{n_pair}: Number of paired observations used for effect size/CIs (complete pairs for the two levels).
  \item \code{missing}: Missing-data strategy used.
}
}
\description{
Performs pairwise post-hoc comparisons for a one-factor repeated-measures design
using paired t-tests (\code{rstatix::pairwise_t_test()}), and adds Cohen's \eqn{d_z}
with both unadjusted and multiplicity-adjusted confidence intervals.
}
\details{
**Post-hoc test**: paired t-tests. \cr
**Effect size**: \eqn{d_z} via \code{effectsize::repeated_measures_d(method = "z")}. \cr
**P-value adjustment**: \code{p_adjust_method} (default: \code{"holm"}). \cr
**CI adjustment**: controlled by \code{ci_adjust_method} (independent of p-value adjustment);
supported: \code{"none"}, \code{"bonferroni"}, \code{"sidak"}.

\strong{Important note on independence of p-adjustment and CI-adjustment}:
P-value adjustment (\code{p_adjust_method}) and CI adjustment (\code{ci_adjust_method}) are independent.
Therefore, it is possible to obtain results where \code{p_adj < 0.05} (significant after p-adjustment)
while the adjusted CI (\code{ci_low_adj}, \code{ci_high_adj}) still includes 0 (or vice versa),
especially when using different adjustment strategies (e.g., \code{p_adjust_method="holm"} and
\code{ci_adjust_method="none"}). This is not a software bug but a consequence of using different
error-control strategies for p-values and confidence intervals.

\strong{Missing-data handling (\code{missing})}
\itemize{
  \item \code{"pairwise"} (default):
  \itemize{
    \item P-values are computed after removing rows with missing DV/within/id.
    \item Effect sizes and CIs are computed pairwise: for each comparison, only IDs with non-missing values
    in the two relevant within-levels are used.
  }
  \item \code{"complete_case"}: Restricts to IDs complete across all within-levels before analysis.
}

\strong{Duplicated ID x within cells}
If duplicated ID x within cells exist, set \code{duplicate} to aggregate values within each cell.
Aggregation is reported via a single warning (not via return columns).

\strong{Meaning of \code{duplicate_na_rm} for \code{duplicate="first"}}:
If \code{duplicate="first"} and \code{duplicate_na_rm=TRUE}, NAs within a duplicated cell are removed
before taking the first value (i.e., the first non-missing value is used).
}
\examples{
dat = datasets::CO2 \%>\%
  dplyr::filter(Type == "Quebec", Treatment == "chilled") \%>\%
  dplyr::mutate(conc = factor(conc))

rm_posthoc(
  dat, dv = uptake, within = conc, id = Plant,
  p_adjust_method = "holm",
  ci_adjust_method = "bonferroni",
  missing = "pairwise"
)

}
