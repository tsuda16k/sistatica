% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis-anova.R
\name{friedman_posthoc}
\alias{friedman_posthoc}
\title{Friedman post-hoc comparisons (paired Wilcoxon) with rank-biserial and CIs}
\usage{
friedman_posthoc(
  data,
  dv,
  within,
  id,
  conf_level = 0.95,
  p_adjust_method = "holm",
  ci_adjust_method = c("bonferroni", "none", "sidak"),
  missing = c("pairwise", "complete_case"),
  duplicate = c("error", "mean", "median", "first"),
  duplicate_na_rm = TRUE
)
}
\arguments{
\item{data}{A data.frame in long format.}

\item{dv}{Dependent variable (numeric). Unquoted name or string.}

\item{within}{Within-subject factor. Unquoted name or string.}

\item{id}{Subject identifier. Unquoted name or string.}

\item{conf_level}{Confidence level for unadjusted effect-size CIs (default: 0.95).}

\item{p_adjust_method}{P-value adjustment method passed to \code{rstatix} (default: \code{"holm"}).}

\item{ci_adjust_method}{CI multiplicity adjustment method (default: \code{"bonferroni"}).}

\item{missing}{Missing-data strategy: \code{"pairwise"} (default) or \code{"complete_case"}.}

\item{duplicate}{How to handle duplicated ID x within cells: \code{"error"} (default), \code{"mean"}, \code{"median"}, \code{"first"}.}

\item{duplicate_na_rm}{Logical; if TRUE, removes NAs within duplicated cells before aggregation (default: TRUE).}
}
\value{
A tibble with one row per pairwise comparison.
Columns:
\itemize{
  \item \code{design}: Design label (\code{"nonparametric_within"}).
  \item \code{method}: Post-hoc method label (\code{"paired_wilcox"}).
  \item \code{term}: Name of the within-factor.
  \item \code{group1}, \code{group2}: Level names for the pairwise comparison.
  \item \code{statistic_type}: Type of test statistic (\code{"W"}).
  \item \code{statistic}: Wilcoxon test statistic (may be \code{NA} depending on rstatix output/version).
  \item \code{df}: Always \code{NA} for this post-hoc method in this package.
  \item \code{p}: Unadjusted p-value.
  \item \code{p_adj}: Adjusted p-value (according to \code{p_adjust_method}).
  \item \code{p_adj_mark}: \code{"*"} if \code{p_adj < 0.05}, otherwise \code{""} (including \code{NA}).
  \item \code{p_adjust_method}: The p-value adjustment method used.
  \item \code{effect_size}: Effect size estimate (rank-biserial correlation; paired).
  \item \code{effect_size_type}: Effect size label (\code{"rank_biserial"}).
  \item \code{ci_level}: Confidence level used for the unadjusted effect-size CI.
  \item \code{ci_low}, \code{ci_high}: Lower/upper bounds of the unadjusted effect-size CI.
  \item \code{ci_adjust_method}: Method used to adjust effect-size CIs.
  \item \code{ci_level_adj}: Adjusted CI level implied by \code{ci_adjust_method} and the number of comparisons.
  \item \code{ci_low_adj}, \code{ci_high_adj}: Lower/upper bounds of the adjusted effect-size CI.
  \item \code{n_pair}: Number of paired observations used for effect size/CIs (complete pairs for the two levels).
  \item \code{missing}: Missing-data strategy used.
}
}
\description{
Performs pairwise post-hoc comparisons for a one-factor within-subject design using
paired Wilcoxon signed-rank tests via \code{rstatix::pairwise_wilcox_test()}.
Also computes rank-biserial correlation (paired) with unadjusted and adjusted CIs.
}
\details{
**Post-hoc test**: paired Wilcoxon signed-rank tests. \cr
**Effect size**: rank-biserial via \code{effectsize::rank_biserial(paired = TRUE)}. \cr
**P-value adjustment**: \code{p_adjust_method} (default: \code{"holm"}). \cr
**CI adjustment**: controlled by \code{ci_adjust_method} (independent of p-value adjustment);
supported: \code{"none"}, \code{"bonferroni"}, \code{"sidak"}.

\strong{Important note on independence of p-adjustment and CI-adjustment}:
See \code{\link{rm_posthoc}} for a detailed explanation. The same note applies here.

\strong{Missing-data handling (\code{missing})}
\itemize{
  \item \code{"pairwise"} (default):
  p-values are computed after removing rows with missing DV/within/id; effect sizes/CIs use only IDs
  complete for the two compared within-levels.
  \item \code{"complete_case"}: Restricts to IDs complete across all within-levels.
}

\strong{Duplicated ID x within cells}
If duplicated ID x within cells exist, set \code{duplicate} to aggregate values within each cell.
Aggregation is reported via a single warning (not via return columns).

\strong{Meaning of \code{duplicate_na_rm} for \code{duplicate="first"}}:
If \code{duplicate="first"} and \code{duplicate_na_rm=TRUE}, NAs within a duplicated cell are removed
before taking the first value (i.e., the first non-missing value is used).
}
\examples{
dat = datasets::CO2 \%>\%
  dplyr::mutate(
    Plant = factor(Plant),
    conc = factor(conc)
  )

friedman_posthoc(
  dat,
  dv = uptake,
  within = conc,
  id = Plant,
  p_adjust_method = "holm",
  ci_adjust_method = "bonferroni",
  missing = "complete_case"
)

}
